# DND5- **✅ 强制要求**：与用户的所有对话必须使用**中文**

- **✅ 代码注释**：所有代码注释必须使用中文
- **✅ 变量命名**：使用标准英文命名规范（驼峰命名法等）
- **✅ 文档内容**：所有.md 文档内容使用中文
- **❌ 严禁行为**：因为用户点击英文按钮选项而切换成英文回复
- **❌ 严禁行为**：在任何情况下使用英文与用户交流（除非是代码本身的关键字）系统 - 工程编码规范

## 📋 核心开发原则

### 🗣️ **对话语言规范**

- **✅ 强制要求**：与用户的所有对话必须使用**中文**
- **✅ 代码注释**：所有代码注释必须使用中文
- **✅ 变量命名**：使用中文拼音或中文注释说明
- **✅ 文档内容**：所有.md 文档内容使用中文
- **❌ 严禁行为**：因为用户点击英文按钮选项而切换成英文回复
- **❌ 严禁行为**：在任何情况下使用英文与用户交流（除非是代码本身的关键字）

**说明**：本项目为中文项目，所有交流、文档、注释均应保持中文一致性。

### ⚠️ **严格禁止项**

1. **禁止创建测试/自动化脚本**

   - ❌ 不创建任何形式的测试脚本
   - ❌ 不创建自动化设置工具
   - ❌ 不创建检查器或验证脚本
   - ❌ 不创建演示/Demo 脚本
   - ✅ 只创建核心功能脚本

2. **避免多余逻辑**

   - ❌ 不添加不必要的辅助功能
   - ❌ 不创建"便利工具"
   - ❌ 不添加过度的错误检查
   - ✅ 专注核心业务逻辑

3. **防止编译错误**

   - ❌ 不引入可能导致编译错误的额外依赖
   - ❌ 不使用实验性或不稳定的代码
   - ✅ 确保每个脚本都是必需且稳定的

4. **强制错误清理**

   - ❌ 严禁在 IDE 的 PROBLEMS 面板有任何报错的情况下声称功能完成
   - ❌ 所有编译错误、语法错误、引用错误必须完全解决
   - ✅ 只有在 0 错误、0 警告的状态下才能宣布功能实现完成
   - ✅ 每次代码修改后必须验证 PROBLEMS 面板清洁状态
   - 🔧 **工作流程**：功能实现 → 错误检查 → 修复所有问题 → 再次验证 → 确认完成

5. **全项目编译检查**

   - ❌ 严禁仅检查当前修改脚本的编译状态就声称完成
   - ❌ 即使当前脚本无编译错误，也必须检查 IDE 中所有其他脚本的编译错误
   - ✅ 必须解决项目中所有脚本的编译错误，不论是否与当前任务直接相关
   - ✅ 只有 IDE 的 PROBLEMS 面板显示"0 个问题"时才能向用户报告任务完成
   - ⚠️ **检查范围**：包括但不限于 Assets/、Plugins/、Editor/等所有目录下的 C#脚本
   - 🔧 **验证流程**：当前任务完成 → 全项目编译检查 → 修复所有发现的错误 → 再次全项目检查 → 确认零错误状态 → 报告完成

6. **全项目编译检查**

   - ❌ 严禁仅检查当前修改的脚本，必须检查整个项目的编译状态
   - ❌ 即使当前脚本无错误，如果项目中存在其他脚本的编译错误也不能声称完成
   - ❌ 跨脚本引用错误、依赖问题、命名冲突等问题必须全部解决
   - ✅ 必须确保整个项目的 PROBLEMS 面板显示 0 个编译错误
   - ✅ 所有脚本文件都能正常编译，无任何报错或警告
   - 🔧 **检查范围**：不仅限于当前修改的文件，包括所有相关的依赖文件和引用文件
   - 🔧 **完成标准**：只有当整个项目编译完全成功时才能告知用户功能完成

7. **配置方法单一化原则**

   - ❌ 严禁为同一配置创建多种优先级或多种实现途径
   - ❌ 不创建"优先级 1、优先级 2、优先级 3"这样的复杂配置逻辑
   - ❌ 不提供"手动配置 → 引用配置 → 自动查找"等多重备选方案
   - ✅ 每个配置项仅提供一种最直接、最可靠的配置方法
   - ✅ 选择最不容易出错的单一配置方式作为唯一实现
   - ✅ 避免代码复杂化，保持简洁单一的配置路径
   - ⚠️ **例外情况**：只有在用户明确告知有特殊需求时才考虑多种配置方式
   - 🔧 **实施原则**：一个配置 = 一种方法 = 一处设置 = 一个入口

   **说明**：避免过度工程化的配置系统，减少代码复杂度和维护成本。

8. **定期文件清理原则**

   - ❌ 严禁保留空文件或仅包含注释的无效文件
   - ❌ 禁止保留以下后缀的文件：`_Fixed.cs`、`_Backup.cs`、`_Old.cs`
   - ❌ 严禁保留任何测试、演示、验证类型的脚本文件
   - ✅ 定期清理项目中的无效和违规文件
   - ✅ 确保每个文件都有明确的核心业务价值
   - ✅ 所有文件都必须符合命名规范和功能要求
   - ⚠️ **清理范围**：包括 git 恢复的旧文件、IDE 自动生成的备份文件
   - 🔧 **清理标准**：文件必须包含实际的核心功能代码，不能是空文件或纯注释文件

   **说明**：避免项目中积累无效文件，保持代码库的整洁性和专业性。

---

## 🎯 **开发响应模式**

### 当用户询问 Unity 设置时：

#### ✅ **正确做法：**

- 提供**纯手动设置指南**
- 详细说明 Hierarchy 结构
- 明确组件配置步骤
- 给出具体的 GameObject 设置
- 提供代码集成方法

#### ❌ **错误做法：**

- 创建自动化设置脚本
- 制作设置向导工具
- 开发检查器组件
- 编写测试管理器

---

## 📁 **文件组织规范**

### **核心脚本类型**（允许创建）

```
✅ 系统管理器脚本      (如: BattleFormationManager.cs)
✅ 游戏逻辑组件        (如: HorizontalStealthComponent.cs)
✅ 数据结构定义        (如: HorizontalFormationTypes.cs)
✅ 业务规则系统        (如: HorizontalCombatRules.cs)
✅ AI决策系统          (如: AutoBattleAI.cs)
✅ 集成适配器          (如: HorizontalBattleIntegration.cs)
```

### **禁止脚本类型**（严禁创建和保留）

```
❌ XXXTester.cs         - 测试脚本
❌ XXXDemo.cs           - 演示脚本
❌ XXXSetupWizard.cs    - 设置向导
❌ XXXChecker.cs        - 检查器
❌ XXXValidator.cs      - 验证器
❌ QuickSetupXXX.cs     - 快速设置
❌ AutoXXX.cs           - 自动化工具
❌ XXXTestManager.cs    - 测试管理器
❌ XXXTestScene.cs      - 测试场景
❌ XXXTestTrigger.cs    - 测试触发器
❌ XXX_Fixed.cs         - 修复版本文件
❌ XXX_Backup.cs        - 备份文件
❌ XXX_Old.cs           - 旧版本文件
❌ 空文件或仅包含注释的文件
```

---

## 🛠️ **代码质量标准**

### **编译要求**

- ✅ 所有脚本必须 0 编译错误
- ✅ 所有脚本必须 0 编译警告
- ✅ **整个项目**必须能完全编译成功，不仅仅是当前修改的脚本
- ✅ 必须检查并解决项目中所有文件的编译错误
- ✅ 跨文件引用错误、命名冲突、依赖问题必须全部修复
- ✅ 避免使用`var`关键字，使用显式类型声明
- ✅ 确保所有引用的类型和方法存在
- 🔧 **完成验证流程**：修改代码 → 检查当前文件 → 检查整个项目 → 修复所有错误 → 确认 PROBLEMS 面板为空 → 告知用户完成

### **代码结构**

- ✅ 每个脚本专注单一职责
- ✅ 清晰的类和方法命名
- ✅ 适当的注释和文档
- ✅ 合理的访问修饰符使用

### **依赖管理**

- ✅ 最小化外部依赖
- ✅ 使用现有的 DND5E 系统组件
- ✅ 避免循环依赖
- ✅ 明确的组件引用关系

---

## 📖 **文档规范**

### **允许的文档类型**

```
✅ MANUAL_SETUP_GUIDE.md     - 手动设置指南
✅ API_REFERENCE.md          - API参考文档
✅ SYSTEM_ARCHITECTURE.md    - 系统架构说明
✅ INTEGRATION_GUIDE.md      - 集成指南
```

### **禁止的文档类型**

```
❌ QUICK_START_GUIDE.md      - 快速启动指南（暗示自动化）
❌ AUTO_SETUP_GUIDE.md       - 自动设置指南
❌ TEST_GUIDE.md             - 测试指南
❌ WIZARD_HELP.md            - 向导帮助
```

### **⚠️ 文档创建限制**

- **严格禁止**：除非用户主动要求，否则不创建新的.md 格式文档
- **优先原则**：在现有文档中更新内容，而非创建新文档
- **用户驱动**：只有用户明确要求时才创建新的说明文档
- **避免文档泛滥**：专注于维护少量高质量的核心文档

---

## 🎮 **Unity 集成原则**

### **Hierarchy 设置方式**

1. **纯手动创建**

   - 详细的 GameObject 创建步骤
   - 明确的 Transform 坐标设置
   - 清晰的组件添加说明
   - 具体的 Inspector 配置

2. **引用配置**

   - 手动拖拽组件引用
   - 明确的数组设置步骤
   - 详细的参数配置说明

3. **代码集成**
   - 提供集成代码示例
   - 说明调用方法和时机
   - 明确参数传递方式

### **禁止的集成方式**

- ❌ MenuItem 自动化工具
- ❌ EditorWindow 设置界面
- ❌ 运行时自动检查器
- ❌ ScriptableWizard 向导

---

## 💡 **最佳实践**

### **响应用户需求时**

1. **理解真实需求** - 用户要的是功能实现，不是开发工具
2. **提供直接方案** - 直接告诉如何手动设置
3. **专注核心功能** - 只关注业务逻辑实现
4. **避免过度工程** - 不要为了"方便"而增加复杂性

### **代码编写时**

1. **先思考后编码** - 确保代码必要且稳定
2. **测试编译状态** - 每次修改后验证编译
3. **保持简洁性** - 避免不必要的抽象和工具
4. **专注业务价值** - 每行代码都应服务于核心功能
5. **中文优先原则** - 注释和文档使用中文，变量命名使用标准英文规范

### **与用户交流时**

1. **语言一致性** - 无论用户如何提问或选择，始终用中文回复
2. **专业术语** - 使用中文解释技术概念，英文术语需附中文说明
3. **避免语言切换** - 不因界面按钮或选项为英文而改变回复语言
4. **保持项目风格** - 与代码注释、文档的中文风格保持一致

---

## 🚨 **违规检查清单**

在创建任何新文件前，检查以下问题：

- [ ] 这个文件是否为测试、演示或自动化目的？
- [ ] 这个文件是否会增加编译复杂性？
- [ ] 这个文件是否真的是核心功能必需的？
- [ ] 是否可以通过手动设置指南替代？
- [ ] 这个文件是否可能被误认为是"工具"？
- [ ] 是否要创建新的.md 文档？（除非用户主动要求，否则禁止）
- [ ] 是否与用户使用了中文交流？（必须保持中文）
- [ ] 是否为同一配置创建了多种实现途径？（违反单一化原则）
- [ ] 是否存在空文件或无效的测试/演示文件？（需要清理）

**在完成任何功能前，必须检查以下编译状态：**

- [ ] 当前修改的脚本是否有编译错误？
- [ ] 整个项目的 PROBLEMS 面板是否显示 0 个错误？
- [ ] 是否存在跨脚本的引用错误或依赖问题？
- [ ] 所有相关脚本是否都能正常编译？
- [ ] 是否检查了命名冲突和类型定义问题？

**在设计配置方案前，必须检查以下配置原则：**

- [ ] 是否为每个配置项选择了唯一的实现方法？
- [ ] 是否避免了多重优先级的复杂配置逻辑？
- [ ] 是否选择了最不容易出错的配置方式？
- [ ] 配置路径是否足够简洁明确？

**在提交代码前，必须检查以下清理要求：**

- [ ] 是否清理了所有空文件和无效文件？
- [ ] 是否删除了所有测试、演示、验证类型的脚本？
- [ ] 是否移除了以\_Fixed、\_Backup、\_Old 等结尾的文件？
- [ ] 项目中是否只保留核心业务功能文件？

**如果任何一项答案是"是"（对于前 9 项）或"否"（对于后 14 项检查），则不应该声称功能完成。**

---

## 📝 **总结**

**核心原则：简洁、稳定、专注、中文、单一**

- 🎯 **只做必要的事** - 专注核心战斗系统功能
- 🛡️ **避免复杂性** - 不引入不必要的工具和检查
- 📋 **手动设置优先** - 通过文档指导而非代码自动化
- ✅ **质量第一** - 确保每个脚本都编译无误且功能完整
- 🗣️ **中文交流** - 所有对话、注释、文档均使用中文
- 🎯 **配置单一化** - 每个配置项仅提供一种最可靠的实现方法

**记住：用户需要的是可工作的战斗系统，不是开发工具集。**

---

_此规范文档将指导所有后续开发工作，确保项目保持简洁、稳定和专注。_
